-- PRÁTICA 1
CREATE DATABASE UDF; 
USE UDF;

CREATE TABLE CLIENTE  
( CODIGO INT AUTO_INCREMENT,  
NOME VARCHAR (50),  
DATACAD DATETIME,  
PRIMARY KEY (CODIGO) ); 

SELECT * FROM CLIENTE;

DESC CLIENTE;

INSERT INTO CLIENTE ( NOME, DATACAD )  
VALUES ( 'Yan Duarte', NOW( ) ), ( 'Faculdade Anhanguera', NOW( ) ), 
( 'Betim Minas Gerais', NOW( ) ); 

-- PRÁTICA 2

DELIMITER $$
CREATE FUNCTION FC_MENSAGEM ( FRASE VARCHAR(100) )
RETURNS CHAR(250)
DETERMINISTIC
BEGIN
     RETURN CONCAT(' Olá ', FRASE, ' Seja Bem Vindo a programação em SQL !!! ' );
END $$
DELIMITER ;

DROP FUNCTION IF EXISTS FC_MENSAGEM;

SELECT CODIGO, NOME, FC_MENSAGEM(NOME) AS MENSAGEM, DATACAD
FROM CLIENTE;

DELIMITER $$
CREATE FUNCTION FC_CALCULA_CUBO( CUBO INT )
RETURNS INT
DETERMINISTIC
BEGIN
    SET CUBO = (CUBO*CUBO*CUBO);
    RETURN (CUBO);
    
END $$
DELIMITER ;

SELECT CODIGO, FC_CALCULA_CUBO(CODIGO) AS FUNCAO_CUBO,
FC_MENSAGEM(NOME) AS FUNCAO_MENSAGEM
FROM CLIENTE;

DELIMITER $$
CREATE FUNCTION FC_IF_ELSE( VALOR INT, CLIENTE VARCHAR(50) )
RETURNS VARCHAR(500)
DETERMINISTIC
BEGIN
     DECLARE MSG VARCHAR(300);
     IF ( VALOR%2 = 0) THEN
     SET MSG = CONCAT(' -> O Código do Cliente ', CLIENTE, ' é PAR ');
     ELSE
     SET MSG = CONCAT(' -> O Código do Cliente ', CLIENTE, ' é IMPAR ');
     END IF;
     RETURN MSG;
     END $$;
     DELIMITER ;

SELECT CODIGO, NOME, DATACAD,
FC_IF_ELSE(CODIGO,NOME) AS FUNCAO_COMPOSTA
FROM CLIENTE;

DELIMITER $$
CREATE FUNCTION FC_CALCULA_FATORIAL(NUMERO INT)
RETURNS INT
DETERMINISTIC 
BEGIN
DECLARE FATORIAL INT DEFAULT 1;
DECLARE CONTADOR INT DEFAULT NUMERO;

WHILE CONTADOR > 1 DO
SET FATORIAL = FATORIAL * CONTADOR;
SET CONTADOR = CONTADOR - 1;
END WHILE;

RETURN FATORIAL;
END $$

SELECT NOME, CODIGO, FC_CALCULA_FATORIAL(CODIGO) AS FATORIAL
FROM CLIENTE;